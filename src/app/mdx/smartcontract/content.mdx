<img
  src="https://donghyeun-blog-images.s3.us-east-1.amazonaws.com/smartContract.jpg"
  width="800"
/>

친구와 내기를 했습니다.

> "내일 비가 오면 네가 커피 사!"

다음 날, 아침에 10분 정도 가벼운 비가 왔고  
친구는 

> "비 왔으니까 커피 사!"

라고 했고,  

저는 "그거 그냥 스쳐 지나간 비였잖아. 진짜 비가 온 게 아니지!"라고 주장했습니다.

결국 우리는 **"얼마나 오면 '비가 왔다'고 할 수 있는지 기준이 없어서"** 내기는 무효가 됐다.

이런 경험, 해보신 적 있나요?

---

## 만약 자동으로, 모두가 납득할 수 있게 결과를 판정해주는 시스템이 있다면?

### 문제의 원인
우리의 내기가 무효가 된 이유는 **명확한 기준이 없었기 때문**입니다.

기상청에서는 **"강우량 1mm 이상, 지속시간 10분 이상"** 을 비로 정의합니다.  
이런 명확한 기준이 있다면, 자동으로 판정할 수 있지 않을까요?

### 스마트컨트랙트
스마트컨트랙트는 블록체인 위에서 **명확한 조건**과 **공식 데이터**를 기준으로,  
사람의 개입 없이 자동으로 약속을 이행해주는 프로그램입니다.

```solidity
// 기상 데이터를 받아서 자동으로 판정하는 스마트컨트랙트
contract WeatherBet {
    address public user1;
    address public user2;
    uint256 public betAmount;
    
    function setResultFromOracle(uint256 rainfall, uint256 duration) public onlyOracle {
        if (rainfall >= 1 && duration >= 600) { // 1mm 이상, 10분(600초) 이상
            payable(user1).transfer(betAmount); // 비가 옴
        } else {
            payable(user2).transfer(betAmount); // 비가 오지 않음
        }
    }
}
```

### 현실적인 제약: Oracle의 필요성
**"기상청 API에서 데이터를 가져온다"** 고 쉽게 말하지만,  
실제로는 **Oracle(오라클)** 이라는 중간 단계가 필요합니다.

- **Chainlink** : 가장 널리 사용되는 오라클 네트워크
- **API3** : API 제공자들이 직접 참여하는 오라클
- **Pyth Network** : 실시간 금융 데이터 오라클

> 💡 이 오라클들이 신뢰되지 않으면, 스마트컨트랙트의 자동화도 무의미해집니다.

---

## 스마트컨트랙트의 탄생: 30년의 여정

### 1994년, 닉 자보의 혁신적인 아이디어
스마트컨트랙트의 개념은 **1994년 컴퓨터 과학자 닉 자보(Nick Szabo)** 에 의해 처음 제안되었습니다.

> "디지털 방식으로 약속을 자동으로 이행하는 시스템을 만들 수 있을까?"

당시 닉 자보는 **자판기**를 예시로 들었습니다.
- 동전을 넣으면 자동으로 음료가 나옴
- 사람의 개입 없이 조건에 따라 자동 실행
- 신뢰할 수 있는 중간 기관 없이도 작동

하지만 당시에는 **블록체인 기술이 없어서** 실현할 수 없었습니다.

### 2008년, 비트코인의 등장
<img
  src="https://donghyeun-blog-images.s3.us-east-1.amazonaws.com/btc.jpg"
  width="800"
/>

**사토시 나카모토**가 비트코인을 발명하면서 블록체인 기술이 탄생했습니다.  
하지만 비트코인은 단순한 **화폐 전송**만 가능했습니다.

### 2015년, 이더리움의 혁명
**비탈릭 부테린**이 이더리움을 만들면서 스마트컨트랙트가 현실이 되었습니다.

> "비트코인은 계산기라면, 이더리움은 스마트폰이다"

이더리움은 **튜링 완전(Turing Complete)** 언어를 지원해서,  
복잡한 프로그램을 블록체인 위에서 실행할 수 있게 되었습니다.

---

## 왜 혁신적인가?

<img
  src="https://donghyeun-blog-images.s3.us-east-1.amazonaws.com/smartcontract2.png"
  width="800"
/>

### 신뢰의 문제 해결
기존에는 **"신뢰할 수 있는 제3자"** 가 필요했습니다.

```
전통적인 방식
나 ↔ 친구 (서로 신뢰해야 함)
  ↓
은행/증권사/중개인 (중간 기관 필요)
```

하지만 스마트컨트랙트는 다릅니다.

```
스마트컨트랙트
나 ↔ 코드(블록체인) ↔ 친구
(코드가 법이 되고, 실행이 보장됨)
```

### 자동화
조건이 충족되면 **자동으로 실행**됩니다.
- 인간의 개입이나 실수 없음
- 감정이나 편견 없이 공정하게 처리

### 투명성
모든 거래 내역이 블록체인에 기록되어 **누구나 검증**할 수 있습니다.

---

## 실제 활용 사례

### 1. DeFi (탈중앙화 금융)
> "은행 없이도 대출받을 수 있다면?"

**기존** : 은행에 신용도 확인 → 대출 승인 → 수수료 지불  
**DeFi** : 스마트컨트랙트에 담보 제공 → 자동으로 대출 실행

### 2. NFT (대체 불가능 토큰)
> "디지털 그림의 진짜 주인이 누구인지 어떻게 증명할까?"

**기존** : 파일을 복사하면 구분 불가  
**NFT** : 블록체인에 소유권 기록 → 위조 불가능

### 3. 투표 시스템
> "투표 결과를 조작할 수 없게 만들려면?"

**기존** : 중앙 기관이 결과 관리 → 조작 가능성  
**스마트컨트랙트** : 투표 내역이 블록체인에 기록 → 조작 불가능

---

## 개발자 관점, 실제로 어떻게 작동할까?

처음에는 복잡해 보였지만, 실제로는 **간단한 if-else 문**과 비슷합니다.

### 핵심 코드 구조

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract StockBet {
    address public user1;
    address public user2;
    uint256 public betAmount;
    bool public isWin;
    address public owner;

    constructor(address _user2) payable {
        user1 = msg.sender;
        user2 = _user2;
        betAmount = msg.value;
        owner = msg.sender;
    }

    modifier onlyOwner() {
        require(msg.sender == owner, "Only owner can call this");
        _;
    }

    function setResult(bool _isWin) public onlyOwner {
        isWin = _isWin;
        
        if (isWin) {
            payable(user1).transfer(betAmount);
        } else {
            payable(user2).transfer(betAmount);
        }
    }

    function getBalance() public view returns (uint256) {
        return address(this).balance;
    }
}
```

### 핵심 개념들

#### **실제 돈이 움직인다**
- `betAmount = msg.value` : 실제 전송된 이더 사용
- 하드코딩된 값이 아닌 실제 베팅 금액

#### **컨트랙트가 은행 역할**
- `getBalance()` : 컨트랙트가 보유한 이더 확인
- 돈을 보관하고 자동으로 이체

#### **자동화된 신뢰**
- 조건 충족 시 즉시 자동 이체
- 사람의 개입 없이 정확한 실행

#### **투명한 상태 관리**
- 모든 상태가 블록체인에 공개
- 숨겨진 정보 없음

### 실제 테스트 결과

<img
  src="https://donghyeun-blog-images.s3.us-east-1.amazonaws.com/smartcontract-deployment.png"
  width="800"
/>

위 이미지는 Remix에서 `StockBet` 컨트랙트를 배포한 결과입니다.

- **✅ 성공적인 배포** : 트랜잭션이 성공적으로 실행됨
- **💰 베팅 금액** : 0.005 ETH (5000000000000000 wei) 전송
- **⛽ 가스 비용** : 335,174 gas 소모
- **🏠 컨트랙트 주소** : `0xf8e81D47203A594245E36C48e151709F0C19fBe8`

> **참고** : 이는 Remix VM (테스트 환경)에서 배포된 주소입니다.

---

## 하지만 한계도 있다

### 1. 확장성 문제
- **TPS (초당 거래량)** 제한
- **가스비** - 실행 비용 발생

### 2. 보안 위험

#### 실제 해킹 사례들
- **DAO 해킹 (2016)** : 360만 ETH (당시 약 5천만 달러) 탈취
- **Poly Network 해킹 (2021)** : 6억 달러 규모의 자금 탈취
- **Ronin Network 해킹 (2022)** : 6억 달러 규모의 자금 탈취

#### 핵심 문제점
- **"배포 후 수정 불가"** : 한번 블록체인에 올라가면 코드 변경 불가능
- **"자금 손실은 영구적"** : 해킹당한 자금은 복구 불가능
- **"투명성의 역설"** : 모든 코드가 공개되어 공격자에게 노출

#### 보안 강화 !

```solidity
// 접근 제어가 없으면 "공정한 자동화"가 무의미해집니다
modifier onlyOwner() {
    require(msg.sender == owner, "Only owner can call this");
    _;
}

modifier onlyOracle() {
    require(msg.sender == oracleAddress, "Only Oracle can call this");
    _;
}
```

### 3. 법적 문제

#### 규제의 불확실성
- **국가별 차이** : 한국은 가상자산 사업자 등록 필수, 미국은 SEC/CFTC 관할 충돌
- **법적 지위 불명확** : 스마트 컨트랙트가 계약인가? 코드인가?
- **실제 사례** : SEC vs Ripple (XRP가 증권인가 화폐인가?)

<SmartContractLegalQuiz />


> 💡 기술은 빠르게 발전하지만, 법에 맞추기가 어렵습니다.

---

## 다시, 커피 내기로 돌아가 보자

~조금 억지스럽겠지만~ 만약 그날 아침,  
우리가 기상청 데이터를 기준으로 만든 스마트컨트랙트를 사용했다면  
애매하게 넘어가는 일은 없었을 겁니다.

**기준은 명확했고, 결과는 자동으로 처리됐을 테니까.**

스마트컨트랙트는 **신뢰할 수 없는 세상**에서,  
**신뢰 가능한 시스템**을 가능하게 하는 혁신적인 기술입니다.

처음엔 복잡하고 어려운 기술처럼 느껴졌지만,  
실제로는 “약속을 자동으로 지켜주는 시스템”이었습니다.

앞으로 더 많은 개발자들이 이 기술을 이해하고 활용하면서  
새로운 형태의 신뢰와 협력이 만들어질 것입니다.

> 💡 스마트컨트랙트는 단순한 기술이 아니라, 신뢰와 자동화의 새로운 패러다임입니다.

---

## 참고 자료

- [Ethereum 공식 문서](https://ethereum.org/developers/docs/)
- [Solidity 공식 문서](https://docs.soliditylang.org/)
- [OpenZeppelin](https://openzeppelin.com/) - 보안 라이브러리